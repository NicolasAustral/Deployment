name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
cols<-c("blue", "red", "green", "yellow", "orange","black", "pink","purple")
ggplot(data1, aes(x=data1$name, y=data1$value)) +
geom_bar(stat = "identity", width=0.2) +
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF"))
data1 <- data.frame(
name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
cols<-c("blue", "red", "green", "yellow", "orange","black", "pink","purple")
ggplot(data1, aes(x=data1$name, y=data1$value)) +
geom_bar(stat = "identity", width=0.2) +
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF"))+
labs(x="Damaged artery", y="Amount of patients")
##De los que tuvieron intervencion previa cuantos tuvieron complicaciones dependiendo el tipo de CIRUGIA
intervencionPrevia<- na.omit(dataset$`INTERVENCION PREVIA`)
intervencionPrevia<- dataset[!is.na(dataset$`INTERVENCION PREVIA`),c(4,37:38)]
intervencionPreviaConComplicaciones<- intervencionPrevia[which(intervencionPrevia$`COMPLICACIONES INMEDIATAS` == "1" | intervencionPrevia$`COMPLICACIONES TARDIAS` == "1"),]
plot_ly(alpha = 1, colors = c("#01DFA5", "#0B614B", "#0B2F3A"),texts=c("a", "b","c"), hoverinfo='texts') %>%
add_histogram(x=intervencionPreviaConComplicaciones$`INTERVENCION PREVIA`,data=na.omit(intervencionPreviaConComplicaciones)) %>%
layout(barmode = "overlay",showlegend = F, title = "Complications according to the type of previous intervention", xaxis = list(title = "Types of previous interventions"), yaxis = list(title = "Amount of people"))
##De los que tuvieron intervencion previa cuantos tuvieron complicaciones dependiendo el tipo de CIRUGIA
intervencionPrevia<- na.omit(dataset$`INTERVENCION PREVIA`)
intervencionPrevia<- dataset[!is.na(dataset$`INTERVENCION PREVIA`),c(4,37:38)]
intervencionPreviaConComplicaciones<- intervencionPrevia[which(intervencionPrevia$`COMPLICACIONES INMEDIATAS` == "1" | intervencionPrevia$`COMPLICACIONES TARDIAS` == "1"),]
plot_ly(alpha = 1, color= color=factor(intervencionPreviaConComplicaciones$'INTERVENCION PREVIA'),colors = c("#01DFA5", "#0B614B", "#0B2F3A"),texts=c("a", "b","c"), hoverinfo='texts') %>%
##De los que tuvieron intervencion previa cuantos tuvieron complicaciones dependiendo el tipo de CIRUGIA
intervencionPrevia<- na.omit(dataset$`INTERVENCION PREVIA`)
intervencionPrevia<- dataset[!is.na(dataset$`INTERVENCION PREVIA`),c(4,37:38)]
intervencionPreviaConComplicaciones<- intervencionPrevia[which(intervencionPrevia$`COMPLICACIONES INMEDIATAS` == "1" | intervencionPrevia$`COMPLICACIONES TARDIAS` == "1"),]
plot_ly(alpha = 1, color=factor(intervencionPreviaConComplicaciones$'INTERVENCION PREVIA'),colors = c("#01DFA5", "#0B614B", "#0B2F3A"),texts=c("a", "b","c"), hoverinfo='texts') %>%
add_histogram(x=intervencionPreviaConComplicaciones$`INTERVENCION PREVIA`,data=na.omit(intervencionPreviaConComplicaciones)) %>%
layout(barmode = "overlay",showlegend = F, title = "Complications according to the type of previous intervention", xaxis = list(title = "Types of previous interventions"), yaxis = list(title = "Amount of people"))
##media de fey
meanFey <- round(mean.default(na.omit(dataset$'FEY')),2)
ggplot(dataset, aes(x = FEY, fill = SEXO)) +
geom_density(alpha = 0.8) +
theme_ridges() +
scale_fill_discrete(name = "Gender", labels = c("Male","Female")) +
theme(legend.position = "top", axis.text.y = element_blank() ) +
geom_vline(xintercept=meanFey, size=1.5, color="black", show.legend = "mean") +
geom_text(aes(x=meanFey - 5, label=paste0("Mean\n",meanFey), y=0.06))  +
labs(y = "" , fill = "Sex", title = "Acumulated graph of FEY for Male(M) and Female(F)") +
scale_fill_manual(values = c("light blue", "pink"))
##diabetes cual fue la CIRUGIA más hecha
diabetic<- dataset[which(dataset$DIABETES=="1"),22]
mostDoneSurgeryEnDiabeticos<- tail(names(sort(table(diabetic$'PROCEDIMIENTO'))), 1)
##obesos cual fue la CIRUGIA más hecha
obesidad<- dataset[which(dataset$`OBESIDAD MORBIDA`=="1"),22]
mostDoneSurgeryEnObesos<- tail(names(sort(table(obesidad$'PROCEDIMIENTO'))), 1)
##hipertensionados cual fue la CIRUGIA más hecha
hipertension<- dataset[which(dataset$`TAS INGRESO RCV` >= 140 | dataset$`TAD INGRESO RCV` >= 90),22]
mostDoneSurgeryEnHipertensionados<- tail(names(sort(table(hipertension$'PROCEDIMIENTO'))), 1)
ejeX <- c(rep("Diabetes" , 3) , rep("Hypertension" , 3) , rep("Obesity" , 3) )
Procedimientos <- rep(c("ANGIOPLASTY" , "SURGERY " , "ENDOVALVE ") , 3)
ejeY <- c(nrow(diabetic[which(diabetic$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(diabetic[which(diabetic$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(diabetic[which(diabetic$PROCEDIMIENTO == "ENDOVALVULA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "ENDOVALVULA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "ENDOVALVULA"),])
)
data <- data.frame(ejeX,Procedimientos,ejeY)
ggplot(data, aes(fill=Procedimientos, y=ejeY, x=ejeX)) +
geom_bar(position="dodge", stat="identity") +
labs(x = "Pre-existing diseases", y = "Amount of patients", title = "Type of procedure for each disease")
##Cuales fueron los vasos angiplastiados mas comunes en pacientes?
personasConVasosAngioplastiados <- dataset[which(!is.na(dataset$`VASOS ANGIOPLASTIADOS`)),c(48:56) ]
CD <- group_by(personasConVasosAngioplastiados, CD) %>% summarise("count"=n())
DA <- group_by(personasConVasosAngioplastiados, DA) %>% summarise("count"=n())
CDPROXIMAL <- group_by(personasConVasosAngioplastiados, CDPROXIMAL) %>% summarise("count"=n())
CXPROXIMAL <- group_by(personasConVasosAngioplastiados, CXPROXIMAL) %>% summarise("count"=n())
LVCX <- group_by(personasConVasosAngioplastiados, LVCX) %>% summarise("count"=n())
DAPROXIMAL <- group_by(personasConVasosAngioplastiados, DAPROXIMAL) %>% summarise("count"=n())
DG <- group_by(personasConVasosAngioplastiados, DG) %>% summarise("count"=n())
TCI <- group_by(personasConVasosAngioplastiados, TCI) %>% summarise("count"=n())
# Create data
data1 <- data.frame(
name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
ggplot(data1, aes(x=data1$name, y=data1$value)) +
geom_bar(stat = "identity") +
scale_fill_manual(values= c(""))+
labs(x="Damaged artery", y="Amount of patients")
##Cuales fueron los vasos angiplastiados mas comunes en pacientes?
personasConVasosAngioplastiados <- dataset[which(!is.na(dataset$`VASOS ANGIOPLASTIADOS`)),c(48:56) ]
CD <- group_by(personasConVasosAngioplastiados, CD) %>% summarise("count"=n())
DA <- group_by(personasConVasosAngioplastiados, DA) %>% summarise("count"=n())
CDPROXIMAL <- group_by(personasConVasosAngioplastiados, CDPROXIMAL) %>% summarise("count"=n())
CXPROXIMAL <- group_by(personasConVasosAngioplastiados, CXPROXIMAL) %>% summarise("count"=n())
LVCX <- group_by(personasConVasosAngioplastiados, LVCX) %>% summarise("count"=n())
DAPROXIMAL <- group_by(personasConVasosAngioplastiados, DAPROXIMAL) %>% summarise("count"=n())
DG <- group_by(personasConVasosAngioplastiados, DG) %>% summarise("count"=n())
TCI <- group_by(personasConVasosAngioplastiados, TCI) %>% summarise("count"=n())
# Create data
data1 <- data.frame(
name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
ggplot(data1, aes(x=data1$name, y=data1$value)) +
geom_bar(stat = "identity") +
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF","01DFA5"))+
labs(x="Damaged artery", y="Amount of patients")
##Cuales fueron los vasos angiplastiados mas comunes en pacientes?
personasConVasosAngioplastiados <- dataset[which(!is.na(dataset$`VASOS ANGIOPLASTIADOS`)),c(48:56) ]
CD <- group_by(personasConVasosAngioplastiados, CD) %>% summarise("count"=n())
DA <- group_by(personasConVasosAngioplastiados, DA) %>% summarise("count"=n())
CDPROXIMAL <- group_by(personasConVasosAngioplastiados, CDPROXIMAL) %>% summarise("count"=n())
CXPROXIMAL <- group_by(personasConVasosAngioplastiados, CXPROXIMAL) %>% summarise("count"=n())
LVCX <- group_by(personasConVasosAngioplastiados, LVCX) %>% summarise("count"=n())
DAPROXIMAL <- group_by(personasConVasosAngioplastiados, DAPROXIMAL) %>% summarise("count"=n())
DG <- group_by(personasConVasosAngioplastiados, DG) %>% summarise("count"=n())
TCI <- group_by(personasConVasosAngioplastiados, TCI) %>% summarise("count"=n())
# Create data
data1 <- data.frame(
name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
ggplot(data1, aes(x=data1$name, y=data1$value, fill=data1$name)) +
geom_bar(stat = "identity") +
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF","01DFA5"))+
labs(x="Damaged artery", y="Amount of patients")
##Cuales fueron los vasos angiplastiados mas comunes en pacientes?
personasConVasosAngioplastiados <- dataset[which(!is.na(dataset$`VASOS ANGIOPLASTIADOS`)),c(48:56) ]
CD <- group_by(personasConVasosAngioplastiados, CD) %>% summarise("count"=n())
DA <- group_by(personasConVasosAngioplastiados, DA) %>% summarise("count"=n())
CDPROXIMAL <- group_by(personasConVasosAngioplastiados, CDPROXIMAL) %>% summarise("count"=n())
CXPROXIMAL <- group_by(personasConVasosAngioplastiados, CXPROXIMAL) %>% summarise("count"=n())
LVCX <- group_by(personasConVasosAngioplastiados, LVCX) %>% summarise("count"=n())
DAPROXIMAL <- group_by(personasConVasosAngioplastiados, DAPROXIMAL) %>% summarise("count"=n())
DG <- group_by(personasConVasosAngioplastiados, DG) %>% summarise("count"=n())
TCI <- group_by(personasConVasosAngioplastiados, TCI) %>% summarise("count"=n())
# Create data
data1 <- data.frame(
name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
ggplot(data1, aes(x=data1$name, y=data1$value, fill=data1$name)) +
geom_bar(stat = "identity") +
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF","01DFA4"))+
labs(x="Damaged artery", y="Amount of patients", lege)
##Cuales fueron los vasos angiplastiados mas comunes en pacientes?
personasConVasosAngioplastiados <- dataset[which(!is.na(dataset$`VASOS ANGIOPLASTIADOS`)),c(48:56) ]
CD <- group_by(personasConVasosAngioplastiados, CD) %>% summarise("count"=n())
DA <- group_by(personasConVasosAngioplastiados, DA) %>% summarise("count"=n())
CDPROXIMAL <- group_by(personasConVasosAngioplastiados, CDPROXIMAL) %>% summarise("count"=n())
CXPROXIMAL <- group_by(personasConVasosAngioplastiados, CXPROXIMAL) %>% summarise("count"=n())
LVCX <- group_by(personasConVasosAngioplastiados, LVCX) %>% summarise("count"=n())
DAPROXIMAL <- group_by(personasConVasosAngioplastiados, DAPROXIMAL) %>% summarise("count"=n())
DG <- group_by(personasConVasosAngioplastiados, DG) %>% summarise("count"=n())
TCI <- group_by(personasConVasosAngioplastiados, TCI) %>% summarise("count"=n())
# Create data
data1 <- data.frame(
name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
ggplot(data1, aes(x=data1$name, y=data1$value, fill=data1$name)) +
geom_bar(stat = "identity") +
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF","01DFA5"))+
labs(x="Damaged artery", y="Amount of patients", lege)
##Cuales fueron los vasos angiplastiados mas comunes en pacientes?
personasConVasosAngioplastiados <- dataset[which(!is.na(dataset$`VASOS ANGIOPLASTIADOS`)),c(48:56) ]
CD <- group_by(personasConVasosAngioplastiados, CD) %>% summarise("count"=n())
DA <- group_by(personasConVasosAngioplastiados, DA) %>% summarise("count"=n())
CDPROXIMAL <- group_by(personasConVasosAngioplastiados, CDPROXIMAL) %>% summarise("count"=n())
CXPROXIMAL <- group_by(personasConVasosAngioplastiados, CXPROXIMAL) %>% summarise("count"=n())
LVCX <- group_by(personasConVasosAngioplastiados, LVCX) %>% summarise("count"=n())
DAPROXIMAL <- group_by(personasConVasosAngioplastiados, DAPROXIMAL) %>% summarise("count"=n())
DG <- group_by(personasConVasosAngioplastiados, DG) %>% summarise("count"=n())
TCI <- group_by(personasConVasosAngioplastiados, TCI) %>% summarise("count"=n())
# Create data
data1 <- data.frame(
name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
ggplot(data1, aes(x=data1$name, y=data1$value, fill=data1$name)) +
geom_bar(stat = "identity") +
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF","01DFA5"))+
labs(x="Damaged artery", y="Amount of patients")
##Cuales fueron los vasos angiplastiados mas comunes en pacientes?
personasConVasosAngioplastiados <- dataset[which(!is.na(dataset$`VASOS ANGIOPLASTIADOS`)),c(48:56) ]
CD <- group_by(personasConVasosAngioplastiados, CD) %>% summarise("count"=n())
DA <- group_by(personasConVasosAngioplastiados, DA) %>% summarise("count"=n())
CDPROXIMAL <- group_by(personasConVasosAngioplastiados, CDPROXIMAL) %>% summarise("count"=n())
CXPROXIMAL <- group_by(personasConVasosAngioplastiados, CXPROXIMAL) %>% summarise("count"=n())
LVCX <- group_by(personasConVasosAngioplastiados, LVCX) %>% summarise("count"=n())
DAPROXIMAL <- group_by(personasConVasosAngioplastiados, DAPROXIMAL) %>% summarise("count"=n())
DG <- group_by(personasConVasosAngioplastiados, DG) %>% summarise("count"=n())
TCI <- group_by(personasConVasosAngioplastiados, TCI) %>% summarise("count"=n())
# Create data
data1 <- data.frame(
name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
ggplot(data1, aes(x=data1$name, y=data1$value, fill=data1$name)) +
geom_bar(stat = "identity") +
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF","01DFA5"))+
labs(x="Damaged artery", y="Amount of patients",legend=FALSE)
##Cuales fueron los vasos angiplastiados mas comunes en pacientes?
personasConVasosAngioplastiados <- dataset[which(!is.na(dataset$`VASOS ANGIOPLASTIADOS`)),c(48:56) ]
CD <- group_by(personasConVasosAngioplastiados, CD) %>% summarise("count"=n())
DA <- group_by(personasConVasosAngioplastiados, DA) %>% summarise("count"=n())
CDPROXIMAL <- group_by(personasConVasosAngioplastiados, CDPROXIMAL) %>% summarise("count"=n())
CXPROXIMAL <- group_by(personasConVasosAngioplastiados, CXPROXIMAL) %>% summarise("count"=n())
LVCX <- group_by(personasConVasosAngioplastiados, LVCX) %>% summarise("count"=n())
DAPROXIMAL <- group_by(personasConVasosAngioplastiados, DAPROXIMAL) %>% summarise("count"=n())
DG <- group_by(personasConVasosAngioplastiados, DG) %>% summarise("count"=n())
TCI <- group_by(personasConVasosAngioplastiados, TCI) %>% summarise("count"=n())
# Create data
data1 <- data.frame(
name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
ggplot(data1, aes(x=data1$name, y=data1$value, fill=data1$name)) +
geom_bar(stat = "identity") +
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF","01DFA5"))+
labs(x="Damaged artery", y="Amount of patients")+
theme(legend.position = "none")
##Cuales fueron los vasos angiplastiados mas comunes en pacientes?
personasConVasosAngioplastiados <- dataset[which(!is.na(dataset$`VASOS ANGIOPLASTIADOS`)),c(48:56) ]
CD <- group_by(personasConVasosAngioplastiados, CD) %>% summarise("count"=n())
DA <- group_by(personasConVasosAngioplastiados, DA) %>% summarise("count"=n())
CDPROXIMAL <- group_by(personasConVasosAngioplastiados, CDPROXIMAL) %>% summarise("count"=n())
CXPROXIMAL <- group_by(personasConVasosAngioplastiados, CXPROXIMAL) %>% summarise("count"=n())
LVCX <- group_by(personasConVasosAngioplastiados, LVCX) %>% summarise("count"=n())
DAPROXIMAL <- group_by(personasConVasosAngioplastiados, DAPROXIMAL) %>% summarise("count"=n())
DG <- group_by(personasConVasosAngioplastiados, DG) %>% summarise("count"=n())
TCI <- group_by(personasConVasosAngioplastiados, TCI) %>% summarise("count"=n())
# Create data
data1 <- data.frame(
name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
ggplot(data1, aes(x=data1$name, y=data1$value, fill=data1$name)) +
geom_bar(stat = "identity") +
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF","#5882FA"))+
labs(x="Damaged artery", y="Amount of patients")+
theme(legend.position = "none")
##Cuales fueron los vasos angiplastiados mas comunes en pacientes?
personasConVasosAngioplastiados <- dataset[which(!is.na(dataset$`VASOS ANGIOPLASTIADOS`)),c(48:56) ]
CD <- group_by(personasConVasosAngioplastiados, CD) %>% summarise("count"=n())
DA <- group_by(personasConVasosAngioplastiados, DA) %>% summarise("count"=n())
CDPROXIMAL <- group_by(personasConVasosAngioplastiados, CDPROXIMAL) %>% summarise("count"=n())
CXPROXIMAL <- group_by(personasConVasosAngioplastiados, CXPROXIMAL) %>% summarise("count"=n())
LVCX <- group_by(personasConVasosAngioplastiados, LVCX) %>% summarise("count"=n())
DAPROXIMAL <- group_by(personasConVasosAngioplastiados, DAPROXIMAL) %>% summarise("count"=n())
DG <- group_by(personasConVasosAngioplastiados, DG) %>% summarise("count"=n())
TCI <- group_by(personasConVasosAngioplastiados, TCI) %>% summarise("count"=n())
# Create data
data1 <- data.frame(
name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
ggplot(data1, aes(x=data1$name, y=data1$value, fill=data1$name)) +
geom_bar(stat = "identity") +
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF","#A9BCF5"))+
labs(x="Damaged artery", y="Amount of patients")+
theme(legend.position = "none")
##Cuales fueron los vasos angiplastiados mas comunes en pacientes?
personasConVasosAngioplastiados <- dataset[which(!is.na(dataset$`VASOS ANGIOPLASTIADOS`)),c(48:56) ]
CD <- group_by(personasConVasosAngioplastiados, CD) %>% summarise("count"=n())
DA <- group_by(personasConVasosAngioplastiados, DA) %>% summarise("count"=n())
CDPROXIMAL <- group_by(personasConVasosAngioplastiados, CDPROXIMAL) %>% summarise("count"=n())
CXPROXIMAL <- group_by(personasConVasosAngioplastiados, CXPROXIMAL) %>% summarise("count"=n())
LVCX <- group_by(personasConVasosAngioplastiados, LVCX) %>% summarise("count"=n())
DAPROXIMAL <- group_by(personasConVasosAngioplastiados, DAPROXIMAL) %>% summarise("count"=n())
DG <- group_by(personasConVasosAngioplastiados, DG) %>% summarise("count"=n())
TCI <- group_by(personasConVasosAngioplastiados, TCI) %>% summarise("count"=n())
# Create data
data1 <- data.frame(
name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
ggplot(data1, aes(x=data1$name, y=data1$value, fill=data1$name)) +
geom_bar(stat = "identity") +
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#A9BCF5","#0080FF"))+
labs(x="Damaged artery", y="Amount of patients")+
theme(legend.position = "none")
##De los que tuvieron intervencion previa cuantos tuvieron complicaciones dependiendo el tipo de CIRUGIA
intervencionPrevia<- na.omit(dataset$`INTERVENCION PREVIA`)
intervencionPrevia<- dataset[!is.na(dataset$`INTERVENCION PREVIA`),c(4,37:38)]
intervencionPreviaConComplicaciones<- intervencionPrevia[which(intervencionPrevia$`COMPLICACIONES INMEDIATAS` == "1" | intervencionPrevia$`COMPLICACIONES TARDIAS` == "1"),]
plot_ly(alpha = 1, color=factor(intervencionPreviaConComplicaciones$'INTERVENCION PREVIA'),
colors = c("#01DFA5", "#0B614B", "#0B2F3A"),texts=c("a", "b","c"), hoverinfo='texts') %>%
add_histogram(x=intervencionPreviaConComplicaciones$`INTERVENCION PREVIA`,data=na.omit(intervencionPreviaConComplicaciones)) %>%
layout(barmode = "overlay",showlegend = F, title = "Complications according to the type of previous intervention", xaxis = list(title = "Types of previous interventions"), yaxis = list(title = "Amount of people"))
##¿Cuál es el motivo de ingreso más común en hombres mayores a 45 años y en mujeres mayores a 55 años?
mayoresA45Hombres<- dataset[which(dataset$`EDAD` >= 45 & dataset$SEXO == "M"),5]
mayoresA55Mujeres<- dataset[which(dataset$`EDAD` >= 55 & dataset$SEXO == "F"),5]
plot_ly(alpha = 1, color=mayoresA45Hombres$`MOTIVO DE INGRESO`) %>%
add_histogram(x=mayoresA45Hombres$`MOTIVO DE INGRESO`,data=na.omit(mayoresA45Hombres)) %>%
layout(barmode = "overlay",showlegend = F, title = "Reasons for admission for men over 45 years of age", xaxis = list(title = "Reasons for admission"), yaxis = list(title = "Amount of people"))
plot_ly(alpha = 1, color=mayoresA55Mujeres$`MOTIVO DE INGRESO`) %>%
add_histogram(x=mayoresA55Mujeres$`MOTIVO DE INGRESO`,data=na.omit(mayoresA55Mujeres)) %>%
layout(barmode = "overlay",showlegend = F, title = "Reasons for admission for women over 55 years of age", xaxis = list(title = "Reasons for admission"), yaxis = list(title = "Amount of people"))
##¿Cuál es el motivo de ingreso más común en hombres mayores a 45 años y en mujeres mayores a 55 años?
mayoresA45Hombres<- dataset[which(dataset$`EDAD` >= 45 & dataset$SEXO == "M"),5]
mayoresA55Mujeres<- dataset[which(dataset$`EDAD` >= 55 & dataset$SEXO == "F"),5]
plot_ly(alpha = 1, color=mayoresA45Hombres$`MOTIVO DE INGRESO`, colors = c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#A9BCF5","#0080FF")) %>%
add_histogram(x=mayoresA45Hombres$`MOTIVO DE INGRESO`,data=na.omit(mayoresA45Hombres)) %>%
layout(barmode = "overlay",showlegend = F, title = "Reasons for admission for men over 45 years of age", xaxis = list(title = "Reasons for admission"), yaxis = list(title = "Amount of people"))
plot_ly(alpha = 1, color=mayoresA55Mujeres$`MOTIVO DE INGRESO`, colors = c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#A9BCF5")) %>%
add_histogram(x=mayoresA55Mujeres$`MOTIVO DE INGRESO`,data=na.omit(mayoresA55Mujeres)) %>%
layout(barmode = "overlay",showlegend = F, title = "Reasons for admission for women over 55 years of age", xaxis = list(title = "Reasons for admission"), yaxis = list(title = "Amount of people"))
##¿Cuál es el motivo de ingreso más común en hombres mayores a 45 años y en mujeres mayores a 55 años?
mayoresA45Hombres<- dataset[which(dataset$`EDAD` >= 45 & dataset$SEXO == "M"),5]
mayoresA55Mujeres<- dataset[which(dataset$`EDAD` >= 55 & dataset$SEXO == "F"),5]
plot_ly(alpha = 1, color=mayoresA45Hombres$`MOTIVO DE INGRESO`, colors = c("#58FAD0","#01DF74","#088A68","#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#A9BCF5","#0080FF")) %>%
add_histogram(x=mayoresA45Hombres$`MOTIVO DE INGRESO`,data=na.omit(mayoresA45Hombres)) %>%
layout(barmode = "overlay",showlegend = F, title = "Reasons for admission for men over 45 years of age", xaxis = list(title = "Reasons for admission"), yaxis = list(title = "Amount of people"))
plot_ly(alpha = 1, color=mayoresA55Mujeres$`MOTIVO DE INGRESO`, colors = c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#A9BCF5")) %>%
add_histogram(x=mayoresA55Mujeres$`MOTIVO DE INGRESO`,data=na.omit(mayoresA55Mujeres)) %>%
layout(barmode = "overlay",showlegend = F, title = "Reasons for admission for women over 55 years of age", xaxis = list(title = "Reasons for admission"), yaxis = list(title = "Amount of people"))
##diabetes cual fue la CIRUGIA más hecha
diabetic<- dataset[which(dataset$DIABETES=="1"),22]
mostDoneSurgeryEnDiabeticos<- tail(names(sort(table(diabetic$'PROCEDIMIENTO'))), 1)
##obesos cual fue la CIRUGIA más hecha
obesidad<- dataset[which(dataset$`OBESIDAD MORBIDA`=="1"),22]
mostDoneSurgeryEnObesos<- tail(names(sort(table(obesidad$'PROCEDIMIENTO'))), 1)
##hipertensionados cual fue la CIRUGIA más hecha
hipertension<- dataset[which(dataset$`TAS INGRESO RCV` >= 140 | dataset$`TAD INGRESO RCV` >= 90),22]
mostDoneSurgeryEnHipertensionados<- tail(names(sort(table(hipertension$'PROCEDIMIENTO'))), 1)
ejeX <- c(rep("Diabetes" , 3) , rep("Hypertension" , 3) , rep("Obesity" , 3) )
Procedimientos <- rep(c("ANGIOPLASTY" , "SURGERY " , "ENDOVALVE ") , 3)
ejeY <- c(nrow(diabetic[which(diabetic$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(diabetic[which(diabetic$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(diabetic[which(diabetic$PROCEDIMIENTO == "ENDOVALVULA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "ENDOVALVULA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "ENDOVALVULA"),])
)
data <- data.frame(ejeX,Procedimientos,ejeY)
ggplot(data, aes(fill=Procedimientos, y=ejeY, x=ejeX), color=data$ejeX) +
geom_bar(position="dodge", stat="identity") +
labs(x = "Pre-existing diseases", y = "Amount of patients", title = "Type of procedure for each disease")+
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A")
##diabetes cual fue la CIRUGIA más hecha
diabetic<- dataset[which(dataset$DIABETES=="1"),22]
mostDoneSurgeryEnDiabeticos<- tail(names(sort(table(diabetic$'PROCEDIMIENTO'))), 1)
##obesos cual fue la CIRUGIA más hecha
obesidad<- dataset[which(dataset$`OBESIDAD MORBIDA`=="1"),22]
mostDoneSurgeryEnObesos<- tail(names(sort(table(obesidad$'PROCEDIMIENTO'))), 1)
##hipertensionados cual fue la CIRUGIA más hecha
hipertension<- dataset[which(dataset$`TAS INGRESO RCV` >= 140 | dataset$`TAD INGRESO RCV` >= 90),22]
mostDoneSurgeryEnHipertensionados<- tail(names(sort(table(hipertension$'PROCEDIMIENTO'))), 1)
ejeX <- c(rep("Diabetes" , 3) , rep("Hypertension" , 3) , rep("Obesity" , 3) )
Procedimientos <- rep(c("ANGIOPLASTY" , "SURGERY " , "ENDOVALVE ") , 3)
ejeY <- c(nrow(diabetic[which(diabetic$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(diabetic[which(diabetic$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(diabetic[which(diabetic$PROCEDIMIENTO == "ENDOVALVULA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "ENDOVALVULA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "ENDOVALVULA"),])
)
data <- data.frame(ejeX,Procedimientos,ejeY)
ggplot(data, aes(fill=Procedimientos, y=ejeY, x=ejeX)) +
geom_bar(position="dodge", stat="identity") +
labs(x = "Pre-existing diseases", y = "Amount of patients", title = "Type of procedure for each disease")+
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A")
##diabetes cual fue la CIRUGIA más hecha
diabetic<- dataset[which(dataset$DIABETES=="1"),22]
mostDoneSurgeryEnDiabeticos<- tail(names(sort(table(diabetic$'PROCEDIMIENTO'))), 1)
##obesos cual fue la CIRUGIA más hecha
obesidad<- dataset[which(dataset$`OBESIDAD MORBIDA`=="1"),22]
mostDoneSurgeryEnObesos<- tail(names(sort(table(obesidad$'PROCEDIMIENTO'))), 1)
##hipertensionados cual fue la CIRUGIA más hecha
hipertension<- dataset[which(dataset$`TAS INGRESO RCV` >= 140 | dataset$`TAD INGRESO RCV` >= 90),22]
mostDoneSurgeryEnHipertensionados<- tail(names(sort(table(hipertension$'PROCEDIMIENTO'))), 1)
ejeX <- c(rep("Diabetes" , 3) , rep("Hypertension" , 3) , rep("Obesity" , 3) )
Procedimientos <- rep(c("ANGIOPLASTY" , "SURGERY " , "ENDOVALVE ") , 3)
ejeY <- c(nrow(diabetic[which(diabetic$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(diabetic[which(diabetic$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(diabetic[which(diabetic$PROCEDIMIENTO == "ENDOVALVULA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "ENDOVALVULA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "ENDOVALVULA"),])
)
data <- data.frame(ejeX,Procedimientos,ejeY)
ggplot(data, aes(fill=Procedimientos, y=ejeY, x=ejeX)) +
geom_bar(position="dodge", stat="identity") +
labs(x = "Pre-existing diseases", y = "Amount of patients", title = "Type of procedure for each disease")+
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A"))
##De los pacientes que fueron a cirugía, cuántos fueron sometidos a una cirugía de revascularización coronaria (CRM)?
fueronACIRUGIA<- dataset[!is.na(dataset$`TIPO DE CIRUGIA`),c(23,25)]
sometidosACRM <- fueronACIRUGIA[fueronACIRUGIA$CRM == "TRUE",]
options(highcharter.theme = hc_theme_smpl(tooltip = list(valueDecimals = 2)))
total <- nrow(sometidosACRM)
percentageAA <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "ANEURISMA AORTICO") / total
percentageCRM <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "CRM PURA") / total
percentageOTRA <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "OTRA") / total
percentagePM <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "PLASTICA MITRAL") / total
percentageRVAO <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "RVAO") / total
percentageRVAOA <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "RVAo + Aorta") / total
percentageRVM <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "RVM") / total
df <- data.frame(
x = c(0, 1, 2, 3, 4, 5, 6),
y = c(percentageAA, percentageCRM, percentageOTRA, percentagePM, percentageRVAO, percentageRVAOA, percentageRVM),
name = as.factor(c("ANEURISMA AORTICO","CRM PURA","OTRA","PLASTICA MITRAL","RVAO","RVAo + Aorta","RVM"))
)
cols<-c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF")
hc <- df %>%
hchart(
"pie", hcaes(x = name, y = y),
name = "subjected to CRM")%>%
hc_colors(cols)
hc
View(dataset)
View(fueronACIRUGIA)
##diabetes cual fue la CIRUGIA más hecha
diabetic<- dataset[which(dataset$DIABETES=="1"),22]
mostDoneSurgeryEnDiabeticos<- tail(names(sort(table(diabetic$'PROCEDIMIENTO'))), 1)
##obesos cual fue la CIRUGIA más hecha
obesidad<- dataset[which(dataset$`OBESIDAD MORBIDA`=="1"),22]
mostDoneSurgeryEnObesos<- tail(names(sort(table(obesidad$'PROCEDIMIENTO'))), 1)
##hipertensionados cual fue la CIRUGIA más hecha
hipertension<- dataset[which(dataset$`TAS INGRESO RCV` >= 140 | dataset$`TAD INGRESO RCV` >= 90),22]
mostDoneSurgeryEnHipertensionados<- tail(names(sort(table(hipertension$'PROCEDIMIENTO'))), 1)
ejeX <- c(rep("Diabetes" , 3) , rep("Hypertension" , 3) , rep("Obesity" , 3) )
Procedimientos <- rep(c("ANGIOPLASTY" , "SURGERY " , "ENDOVALVE ") , 3)
ejeY <- c(nrow(diabetic[which(diabetic$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(diabetic[which(diabetic$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(diabetic[which(diabetic$PROCEDIMIENTO == "ENDOVALVULA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(hipertension[which(hipertension$PROCEDIMIENTO == "ENDOVALVULA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "ANGIOPLASTIA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "CIRUGIA"),]),
nrow(obesidad[which(obesidad$PROCEDIMIENTO == "ENDOVALVULA"),])
)
data <- data.frame(ejeX,Procedimientos,ejeY)
ggplot(data, aes(fill=Procedimientos, y=ejeY, x=ejeX)) +
geom_bar(position="dodge", stat="identity") +
labs(x = "Pre-existing diseases", y = "Amount of patients", title = "Type of procedure for each disease")+
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A"))
##De los que tuvieron intervencion previa cuantos tuvieron complicaciones dependiendo el tipo de CIRUGIA
intervencionPrevia<- na.omit(dataset$`INTERVENCION PREVIA`)
intervencionPrevia<- dataset[!is.na(dataset$`INTERVENCION PREVIA`),c(4,37:38)]
intervencionPreviaConComplicaciones<- intervencionPrevia[which(intervencionPrevia$`COMPLICACIONES INMEDIATAS` == "1" | intervencionPrevia$`COMPLICACIONES TARDIAS` == "1"),]
plot_ly(alpha = 1, color=factor(intervencionPreviaConComplicaciones$'INTERVENCION PREVIA'),
colors = c("#01DFA5", "#0B614B", "#0B2F3A"),texts=c("a", "b","c"), hoverinfo='texts') %>%
add_histogram(x=intervencionPreviaConComplicaciones$`INTERVENCION PREVIA`,data=na.omit(intervencionPreviaConComplicaciones)) %>%
layout(barmode = "overlay",showlegend = F, title = "Complications according to the type of previous intervention", xaxis = list(title = "Types of previous interventions"), yaxis = list(title = "Amount of people"))
rmarkdown::render_site()
##De los pacientes que fueron a cirugía, cuántos fueron sometidos a una cirugía de revascularización coronaria (CRM)?
fueronACIRUGIA<- dataset[!is.na(dataset$`TIPO DE CIRUGIA`),c(23,25)]
sometidosACRM <- fueronACIRUGIA[fueronACIRUGIA$CRM == "TRUE",]
options(highcharter.theme = hc_theme_smpl(tooltip = list(valueDecimals = 2)))
total <- nrow(sometidosACRM)
percentageAA <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "ANEURISMA AORTICO") / total
percentageCRM <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "CRM PURA") / total
percentageOTRA <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "OTRA") / total
percentagePM <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "PLASTICA MITRAL") / total
percentageRVAO <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "RVAO") / total
percentageRVAOA <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "RVAo + Aorta") / total
percentageRVM <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "RVM") / total
df <- data.frame(
x = c(0, 1, 2, 3, 4, 5, 6),
y = c(percentageAA, percentageCRM, percentageOTRA, percentagePM, percentageRVAO, percentageRVAOA, percentageRVM),
name = as.factor(c("ANEURISMA AORTICO","CRM PURA","OTRA","PLASTICA MITRAL","RVAO","RVAo + Aorta","RVM"))
)
cols<-c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF")
hc <- df %>%
hchart(
"pie", hcaes(x = name, y = y),
name = "subjected to CRM")%>%
hc_colors(cols)
hc
##De los pacientes que fueron a cirugía, cuántos fueron sometidos a una cirugía de revascularización coronaria (CRM)?
fueronACIRUGIA<- dataset[!is.na(dataset$`TIPO DE CIRUGIA`),c(23,25)]
sometidosACRM <- fueronACIRUGIA[fueronACIRUGIA$CRM == "TRUE",]
options(highcharter.theme = hc_theme_smpl(tooltip = list(valueDecimals = 2)))
total <- nrow(sometidosACRM)
percentageAA <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "ANEURISMA AORTICO") / total
percentageCRM <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "CRM PURA") / total
percentageOTRA <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "OTRA") / total
percentagePM <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "PLASTICA MITRAL") / total
percentageRVAO <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "RVAO") / total
percentageRVAOA <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "RVAo + Aorta") / total
percentageRVM <- 100 * sum(sometidosACRM$`TIPO DE CIRUGIA` == "RVM") / total
df <- data.frame(
x = c(0, 1, 2, 3, 4, 5, 6),
y = c(percentageAA, percentageCRM, percentageOTRA, percentagePM, percentageRVAO, percentageRVAOA, percentageRVM),
name = as.factor(c("ANEURISMA AORTICO","CRM PURA","OTRA","PLASTICA MITRAL","RVAO","RVAo + Aorta","RVM"))
)
cols<-c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#0080FF")
hc <- df %>%
hchart(
"pie", hcaes(x = name, y = y),
name = "subjected to CRM")%>%
hc_colors(cols)
hc
##Cuales fueron los vasos angiplastiados mas comunes en pacientes?
personasConVasosAngioplastiados <- dataset[which(!is.na(dataset$`VASOS ANGIOPLASTIADOS`)),c(48:56) ]
CD <- group_by(personasConVasosAngioplastiados, CD) %>% summarise("count"=n())
DA <- group_by(personasConVasosAngioplastiados, DA) %>% summarise("count"=n())
CDPROXIMAL <- group_by(personasConVasosAngioplastiados, CDPROXIMAL) %>% summarise("count"=n())
CXPROXIMAL <- group_by(personasConVasosAngioplastiados, CXPROXIMAL) %>% summarise("count"=n())
LVCX <- group_by(personasConVasosAngioplastiados, LVCX) %>% summarise("count"=n())
DAPROXIMAL <- group_by(personasConVasosAngioplastiados, DAPROXIMAL) %>% summarise("count"=n())
DG <- group_by(personasConVasosAngioplastiados, DG) %>% summarise("count"=n())
TCI <- group_by(personasConVasosAngioplastiados, TCI) %>% summarise("count"=n())
# Create data
data1 <- data.frame(
name=c("CD","DA","CDPROXIMAL","CXPROXIMAL","LVCX", "DAPROXIMAL", "DG", "TCI") ,
value=c(CD$count[2], DA$count[2], CDPROXIMAL$count[2], CXPROXIMAL$count[2], LVCX$count[2], DAPROXIMAL$count[2], DG$count[2], TCI$count[2]))
ggplot(data1, aes(x=data1$name, y=data1$value, fill=data1$name)) +
geom_bar(stat = "identity") +
scale_fill_manual(values= c("#01DFA5", "#0B614B", "#0B2F3A", "#086A87", "#01A9DB","#2ECCFA","#A9BCF5","#0080FF"))+
labs(x="Damaged artery", y="Amount of patients")+
theme(legend.position = "none")
